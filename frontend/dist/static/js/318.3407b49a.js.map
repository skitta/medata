{"version":3,"file":"static/js/318.3407b49a.js","mappings":"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","sources":["webpack://frontend/./src/views/home/add/AddPatientView.vue","webpack://frontend/./src/views/home/add/AddPatientView.vue?a050"],"sourcesContent":["<template>\n  <a-card title=\"添加新患者\">\n    <a-form name=\"Patient\" ref=\"formRef\" :model=\"formState\" :rules=\"rules\" :label-col=\"{ span: 4 }\"\n      :wrapper-col=\"{ span: 18 }\">\n      <a-form-item label=\"登记号\" name=\"registered_ID\">\n        <a-input v-model:value=\"formState.registered_ID\" />\n      </a-form-item>\n      <a-form-item label=\"住院号\" name=\"document_ID\">\n        <a-input v-model:value=\"formState.document_ID\" />\n      </a-form-item>\n      <a-form-item label=\"姓名\" name=\"full_name\">\n        <a-input v-model:value=\"formState.full_name\" />\n      </a-form-item>\n      <a-form-item label=\"性别\" name=\"gender\">\n        <a-select v-model:value=\"formState.gender\">\n          <a-select-option value=\"M\">男</a-select-option>\n          <a-select-option value=\"F\">女</a-select-option>\n        </a-select>\n      </a-form-item>\n      <a-form-item label=\"年龄(月)\" name=\"age\">\n        <a-input-number v-model:value=\"formState.age\" style=\"width: 100%\" />\n      </a-form-item>\n      <a-form-item label=\"入院日期\" name=\"in_date\">\n        <a-date-picker v-model:value=\"formState.in_date\" value-format=\"YYYY-MM-DD\" style=\"width: 100%\" />\n      </a-form-item>\n      <a-form-item label=\"身高(cm)\" name=\"height\">\n        <a-input-number v-model:value=\"formState.height\" style=\"width: 100%\" />\n      </a-form-item>\n      <a-form-item label=\"体重(kg)\" name=\"weight\">\n        <a-input-number v-model:value=\"formState.weight\" style=\"width: 100%\" />\n      </a-form-item>\n      <a-form-item label=\"分组\" v-model:value=\"formState.group\" name=\"group\">\n        <a-select v-model:value=\"formState.group\" :options=\"groupOptions\"></a-select>\n      </a-form-item>\n      <a-form-item label=\"IVIG 抵抗\" v-model:value=\"formState.resistance\" name=\"resistance\">\n        <a-radio-group v-model:value=\"formState.resistance\">\n          <a-radio :value=\"true\">是</a-radio>\n          <a-radio :value=\"false\">否</a-radio>\n        </a-radio-group>\n      </a-form-item>\n      <a-form-item label=\"复发病历\" v-model:value=\"formState.relapse\" name=\"relapse\">\n        <a-radio-group v-model:value=\"formState.relapse\">\n          <a-radio :value=\"true\">是</a-radio>\n          <a-radio :value=\"false\">否</a-radio>\n        </a-radio-group>\n      </a-form-item>\n      <a-form-item :wrapper-col=\"{ span: 14, offset: 4 }\">\n        <a-button type=\"primary\" @click=\"showModal\">确认</a-button>\n      </a-form-item>\n    </a-form>\n    <a-modal v-model:visible=\"modalVisible\" title=\"确认信息\" @ok=\"handleOk\" :confirm-loading=\"confireLoading\">\n      <p>{{ modalMsg }}</p>\n    </a-modal>\n  </a-card>\n</template>\n\n<script>\nimport { defineComponent, ref, reactive, toRaw, onMounted } from \"vue\";\nimport {\n  Card, Form, Input, Select, DatePicker, InputNumber, Button, Modal, Radio, message\n} from \"ant-design-vue\";\nimport { useStore } from \"vuex\";\nimport { getGroups, getPatients, getTestsByPatientId, addPatient } from \"@/api/kawasaki\";\nimport { useRouter } from \"vue-router\";\n\nconst { Item } = Form;\nconst { Option } = Select;\nconst { Group } = Radio;\n\nexport default defineComponent({\n  name: \"PatientForm\",\n  components: {\n    ACard: Card,\n    AForm: Form,\n    AFormItem: Item,\n    AInput: Input,\n    ASelect: Select,\n    ASelectOption: Option,\n    ADatePicker: DatePicker,\n    AInputNumber: InputNumber,\n    AButton: Button,\n    AModal: Modal,\n    ARadioGroup: Group,\n    ARadio: Radio,\n  },\n\n  setup() {\n    const formRef = ref();\n    const formState = reactive({\n      registered_ID: \"\",\n      document_ID: \"\",\n      full_name: \"\",\n      gender: \"\",\n      age: undefined,\n      in_date: undefined,\n      height: undefined,\n      weight: undefined,\n      group: \"\",\n      resistance: false,\n      relapse: false\n    });\n    const groupOptions = ref([]);\n    onMounted(() => {\n      getGroups().then(data => {\n        groupOptions.value = data;\n      });\n    });\n\n    const modalVisible = ref(false);\n    const modalMsg = ref(\"\");\n    const confireLoading = ref(false);\n\n    let checkAge = async (rule, value) => {\n      if (!value) {\n        return Promise.reject(\"请输入年龄\");\n      }\n      if (!Number.isInteger(value)) {\n        return Promise.reject(\"年龄必须为整数\");\n      } else if (value < 0) {\n        return Promise.reject(\"年龄不能小于0\");\n      } else {\n        return Promise.resolve();\n      }\n    };\n\n    let checkHeightAndWeight = async (rule, value) => {\n      if (!value) {\n        return Promise.reject(\"请输入数字\");\n      }\n      if (value < 0) {\n        return Promise.reject(\"不能小于0\");\n      }\n      return Promise.resolve();\n    };\n\n    //TODO: 检索登记号是否已存在\n    let existPatient = {};\n    const checkRegisteredID = async (rule, value) => {\n      if (!value) {\n        return Promise.reject(\"请输入登记号\");\n      }\n      try {\n        const data = await getPatients({ search: value });\n        if (data.count > 0) {\n          existPatient = data.results[0];\n          modalMsg.value = \"登记号已存在，是否直接加载？\";\n          modalVisible.value = true;\n          return Promise.reject(\"登记号已存在\");\n        } else {\n          existPatient = {};\n          modalMsg.value = \"\";\n          modalVisible.value = false;\n          return Promise.resolve();\n        }\n      } catch (error) {\n        console.log(error);\n        return Promise.reject(\"检索登记号失败\");\n      }\n    };\n\n    const rules = {\n      registered_ID: [{ required: true, validator: checkRegisteredID, trigger: \"blur\" }],\n      // document_ID: [{ required: true, message: \"请输入住院号\", trigger: \"blur\" }],\n      full_name: [{ required: true, message: \"请输入姓名\", trigger: \"blur\" }],\n      gender: [{ required: true, message: \"请选择性别\", trigger: \"blur\" }],\n      age: [{ required: true, validator: checkAge, trigger: \"blur\" }],\n      in_date: [{ required: true, message: \"请选择日期\", trigger: \"blur\" }],\n      height: [{ required: true, validator: checkHeightAndWeight, trigger: \"blur\" }],\n      weight: [{ required: true, validator: checkHeightAndWeight, trigger: \"blur\" }],\n      group: [{ required: true, message: \"请选择分组\", trigger: \"blur\" }],\n      status: [{ required: true, message: \"请选择状态\", trigger: \"blur\" }],\n    };\n\n    const showModal = () => {\n      formRef.value\n        .validate()\n        .then(() => {\n          modalMsg.value = \"确认后部分字段将无法更改，是否确认？\";\n          modalVisible.value = true;\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    }\n\n    const store = useStore();\n    const router = useRouter();\n\n    const handleOk = () => {\n      confireLoading.value = true;\n      if (Object.keys(existPatient).length > 0) {\n        // 如果数据库中存在该患者，则获取该患者的所有临床数据\n        getTestsByPatientId(existPatient.id)\n          .then(data => {\n            store.dispatch(\"setTests\", data);\n            store.dispatch(\"setPatient\", existPatient);\n            confireLoading.value = false;\n            modalVisible.value = false;\n            router.push({ name: \"add-tests\" });\n          }).catch(error => {\n            console.log(error);\n            confireLoading.value = false;\n            modalMsg.value = \"加载数据失败\";\n            message.error(\"加载数据失败\");\n          });\n      } else {\n        // 否则提交新患者至数据库\n        addPatient(toRaw(formState))\n          .then(data => {\n            store.dispatch(\"setPatient\", data);\n            store.dispatch(\"setTests\", {});\n            confireLoading.value = false;\n            modalVisible.value = false;\n            router.push({ name: \"add-tests\" });\n          }).catch(error => {\n            console.log(error);\n            confireLoading.value = false;\n            modalMsg.value = \"提交数据失败\";\n            message.error(\"提交数据失败\");\n          });\n      }\n    }\n\n    return {\n      formRef,\n      formState,\n      groupOptions,\n      modalVisible,\n      modalMsg,\n      confireLoading,\n      rules,\n      showModal,\n      handleOk,\n    };\n  }\n})\n</script>","import { render } from \"./AddPatientView.vue?vue&type=template&id=4479a3d1\"\nimport script from \"./AddPatientView.vue?vue&type=script&lang=js\"\nexport * from \"./AddPatientView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/chainta/Documents/Codes/PycharmProjects/Django/medata/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createBlock","_component_a_card","title","_createVNode","_component_a_form","name","ref","model","_ctx","rules","span","_component_a_form_item","label","_component_a_input","value","registered_ID","$event","document_ID","full_name","_component_a_select","gender","_component_a_select_option","_component_a_input_number","age","style","_component_a_date_picker","in_date","height","weight","group","options","resistance","_component_a_radio_group","_component_a_radio","relapse","offset","_component_a_button","type","onClick","_component_a_modal","visible","onOk","_createElementVNode","_toDisplayString","Item","Option","Group","defineComponent","components","ACard","AForm","AFormItem","AInput","ASelect","ASelectOption","ADatePicker","AInputNumber","AButton","AModal","ARadioGroup","ARadio","setup","formRef","formState","reactive","undefined","groupOptions","onMounted","getGroups","then","data","modalVisible","modalMsg","confireLoading","checkAge","async","rule","Number","isInteger","Promise","reject","resolve","checkHeightAndWeight","existPatient","checkRegisteredID","getPatients","search","count","results","error","console","log","required","validator","trigger","message","status","showModal","validate","catch","store","useStore","router","useRouter","handleOk","Object","keys","length","getTestsByPatientId","id","dispatch","push","addPatient","toRaw","__exports__","render"],"sourceRoot":""}