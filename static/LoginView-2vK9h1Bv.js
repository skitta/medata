import{c as o,I as O,d as k,u as y,r as S,a as A,b as _,w as i,e as u,o as h,f as P,g as p,h as x,i as C}from"./index-BhHKsdmV.js";import{a as m,b as L}from"./js.cookie-zE7E1cTn.js";import{C as R}from"./index-CiFTF0mN.js";import{F as T,A as U}from"./index-BBhBT8Pw.js";import{S as V,I,A as B}from"./index-zHM7v96u.js";import{U as E}from"./UserOutlined-miXFUUl_.js";import{B as N,A as z}from"./index-DcXvgCjb.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BMKGhP6v.js";import"./hasIn-CsO9C-3B.js";import"./useMergedState-B8DTPsKU.js";import"./PlusOutlined-N5e3bSjW.js";import"./Col-CzR3t48K.js";var M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};function b(s){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?Object(arguments[t]):{},e=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(a).filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable}))),e.forEach(function(n){j(s,n,a[n])})}return s}function j(s,t,a){return t in s?Object.defineProperty(s,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[t]=a,s}var f=function(t,a){var e=b({},t,a.attrs);return o(O,b({},e,{icon:M}),null)};f.displayName="LockOutlined";f.inheritAttrs=!1;const D="/static/doctor-05z3OTPM.svg",H="";m.defaults.baseURL=`${H}/api/`;m.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";m.defaults.headers.post["X-CSRFToken"]=L.get("csrftoken")||"";function $(s,t){return new Promise((a,e)=>{m.post("token-auth/",{username:s,password:t}).then(n=>{a(n.data.token)}).catch(n=>{e(n)})})}const Q={class:"login"},W={class:"login-card-container"},X={key:0},q=k({__name:"LoginView",setup(s){const t=y();t.setToken(null);const a=P(),e=S({user:"",password:"",role:"doctor",msg:""}),n=[{value:"doctor",label:"Doctor"},{value:"patient",label:"Patient"}],d=A(!1),w=()=>{d.value=!0;const{user:v,password:r}=e;$(v,r).then(l=>{t.setToken(l),d.value=!1}).then(()=>{a.push({name:"home"})}).catch(l=>{d.value=!1,console.log(l),l.code==="ERR_NETWORK"?e.msg="网络错误":l.code==="ERR_BAD_REQUEST"?e.msg="用户名或密码错误":e.msg="未知错误"})},g=()=>{e.msg=""};return(v,r)=>{const l=U;return h(),_("div",Q,[o(u(R),{hoverable:"",class:"login-card"},{cover:i(()=>r[3]||(r[3]=[p("div",{class:"login-cover"},[p("img",{src:D,alt:"cover"})],-1)])),default:i(()=>[p("div",W,[o(u(T),{model:e,onSubmit:w},{default:i(()=>[o(l,null,{default:i(()=>[o(u(V),{value:e.role,"onUpdate:value":r[0]||(r[0]=c=>e.role=c),options:n,placeholder:"Select a role"},null,8,["value"])]),_:1}),o(l,null,{default:i(()=>[o(u(I),{value:e.user,"onUpdate:value":r[1]||(r[1]=c=>e.user=c),placeholder:"Username",onChange:g},{prefix:i(()=>[o(u(E),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),o(l,null,{default:i(()=>[o(u(B),{value:e.password,"onUpdate:value":r[2]||(r[2]=c=>e.password=c),placeholder:"Password",onChange:g},{prefix:i(()=>[o(u(f),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),o(l,null,{default:i(()=>[o(u(N),{type:"primary","html-type":"submit",disabled:e.user===""||e.password==="",loading:d.value},{default:i(()=>r[4]||(r[4]=[C(" Log in ")])),_:1,__:[4]},8,["disabled","loading"])]),_:1})]),_:1},8,["model"]),e.msg.length!=0?(h(),_("div",X,[o(u(z),{message:e.msg,type:"error","show-icon":""},null,8,["message"])])):x("",!0)])]),_:1})])}}}),ie=F(q,[["__scopeId","data-v-428cc7a6"]]);export{ie as default};
